
((digest . "90336f6d5f4c8a85797e58fce37b7b17") (undo-list nil ("ｈ" . -10977) ((marker . 10977) . -1) (10977 . 10978) ("ｈ" . -10977) ((marker . 10977) . -1) (10977 . 10978) (t 23318 25527 0 0) nil ("
" . -11988) ((marker . 11988) . -1) ((marker . 10977) . -1) ((marker . 9280) . -1) ((marker . 9280) . -1) ((marker . 9930) . -1) ("
" . -11989) ((marker . 11988) . -1) ((marker . 10236) . -1) ((marker . 10236) . -1) ((marker . 10977) . -1) ((marker . 9930) . -1) ("        # RDSに記録する処理
        datetime = \"\\\"\" + date + \" \" + time + \"\\\"\"
        sql_list = [datetime, bid ,ask]
        sql_list.extend([posion_buy_units, position_sell_units, balance, p['fukumi'],com])
        maped_list = map(str, sql_list)
        value_string = ','.join(maped_list)

        with self.stat_db_connect.cursor() as cursor:
            sql_query = \"insert into {0} values ({1});\".format(self.stat_table,value_string)
            r = cursor.execute(sql_query)
            self.stat_db_connect.commit()

        # dynamoDBに記録する処理
        # DecimalにしないとdynamoDBに格納できない
        decimal_action_list = []
        for a in action_list.tolist():
            decimal_action_list.append(decimal.Decimal(str(a)))

        decimal_score_list = []
        for s in score:
            decimal_score_list.append(decimal.Decimal(str(s)))

        self.program_table.put_item(Item = {'timestamp': datetime, 'model': self.modelname, 'score': decimal_score_list, 'action': decimal_action_list})" . -11990) ((marker . 9304) . -21) ((marker . 9304) . -21) ((marker . 9334) . -72) ((marker . 9334) . -72) ((marker . 9511) . -342) ((marker . 9511) . -342) ((marker . 9528) . -477) ((marker . 9528) . -477) ((marker . 9536) . -519) ((marker . 9536) . -519) ((marker . 9519) . -435) ((marker . 9519) . -435) ((marker . 9379) . -112) ((marker . 9379) . -112) ((marker . 9412) . -203) ((marker . 9412) . -203) ((marker . 9461) . -243) ((marker . 9461) . -243) ((marker . 9462) . -287) ((marker . 9462) . -287) ((marker . 9510) . -288) ((marker . 9510) . -288) ((marker . 10977) . -993) ((marker . 9737) . -617) ((marker . 9737) . -617) ((marker . 9759) . -656) ((marker . 9759) . -656) ((marker . 9773) . -720) ((marker . 9773) . -720) ((marker . 9817) . -721) ((marker . 9817) . -721) ((marker . 9826) . -753) ((marker . 9826) . -753) ((marker . 9834) . -777) ((marker . 9834) . -777) ((marker . 9849) . -840) ((marker . 9849) . -840) ((marker . 9857) . -841) ((marker . 9857) . -841) ((marker . 9650) . -584) ((marker . 9650) . -584) ((marker . 9620) . -546) ((marker . 9620) . -546) ((marker . 9567) . -520) ((marker . 9567) . -520) ((marker) . -993) ((marker*) . 1) ((marker) . -993) ((marker*) . 117) ((marker) . -993) ((marker . 9930) . -841) 12983 (t 23318 25483 0 0) nil ("
" . 6921) ((marker . 10261) . -1) ((marker . 10261) . -1) ((marker . 9970) . -1) (t 23318 25459 0 0) nil ("status, " . -6874) ((marker . 10977) . -8) 6882 nil ("data = " . -6882) ((marker . 10977) . -7) 6889 nil (6889 . 6894) (t 23318 25447 0 0) nil ("
" . 6969) ((marker . 10395) . -1) ((marker . 10395) . -1) ((marker . 9970) . -1) nil ("
" . -6969) ((marker . 11988) . -1) ((marker . 10228) . -1) ((marker . 10228) . -1) ((marker . 10977) . -1) ((marker . 6958) . -1) ((marker . 9930) . -1) 6970 nil ("    '''
    タイムアウトしたチケットを取得
    '''
    def __get_timeout_ticket_ids__(self, now_time_utc):
        status, data = oanda_function.get_ticket(self.instrument)

        if status == 'Error':
            self.tsuchi_kun.send_text('Error', \"__get_timeout_ticket_ids__(): {}\".format(str(data)))
            return []
        elif status == 'NOT_FOUND':
            return []
        else:
            tickets = data.get('trades')
            result = []
            # タイムアウトしたチケットを取得
            for ticket in tickets[::-1]:
                if ticket['instrument']==self.instrument:
                    t_utc = datetime.strptime(ticket[\"time\"], '%Y-%m-%dT%H:%M:%S.%fZ').replace(tzinfo=timezone('UTC'))
                    if now_time_utc - t_utc > timedelta(minutes=self.predict_period):
                        result.append(ticket[\"id\"])
            return result" . -6970) ((marker . 11010) . -384) ((marker . 11010) . -384) ((marker . 11041) . -425) ((marker . 11041) . -425) ((marker . 11083) . -449) ((marker . 11083) . -449) ((marker . 11119) . -479) ((marker . 11119) . -479) ((marker . 11153) . -520) ((marker . 11153) . -520) ((marker . 11186) . -578) ((marker . 11186) . -578) ((marker . 11231) . -697) ((marker . 11231) . -697) ((marker . 11245) . -783) ((marker . 11245) . -783) ((marker . 11278) . -835) ((marker . 11278) . -835) ((marker . 10978) . -370) ((marker . 10978) . -370) ((marker . 10950) . -348) ((marker . 10950) . -348) ((marker . 10919) . -312) ((marker . 10919) . -312) ((marker . 10883) . -290) ((marker . 10883) . -290) ((marker . 10851) . -189) ((marker . 10851) . -189) ((marker . 10819) . -159) ((marker . 10819) . -159) ((marker . 10774) . -158) ((marker . 10774) . -158) ((marker . 10729) . -92) ((marker . 10729) . -92) ((marker . 10728) . -36) ((marker . 10728) . -36) ((marker . 10473) . -28) ((marker . 10473) . -28) ((marker . 10395) . -8) ((marker . 10395) . -8) ((marker . 10977) . -860) ((marker) . -860) ((marker . 9930) . -835) 7830 (t 23318 25436 0 0) nil (7830 . 7839) (t 23318 25371 0 0) nil ("
" . -9152) ((marker . 11988) . -1) ((marker . 10977) . -1) ((marker . 9930) . -1) ("
" . -9153) ((marker . 11988) . -1) ((marker . 10977) . -1) ((marker . 9930) . -1) ("
" . -9154) ((marker . 11988) . -1) ((marker . 10977) . -1) ((marker . 9930) . -1) ("    '''
    チケットクローズ
    '''
    def __close_tickets__(self, ticket_ids):
        if len(ticket_ids) == 0:
            return

        for id in ticket_ids:
            status, data = oanda_function.close_ticket(id)
            if status == 'Error':
                self.tsuchi_kun.send_text('Error', \"__close_tickets__(): {}\".format(str(data)))
            else:
                s = data.get('side')
        b = self.__get_balance__()
        diff = b - self.last_balance
        message = {
            \"サイド\":s, #両建てできないので最後のチケットのサイドを表示すれば良い
            \"損益\": \"¥{:,d}\".format(diff)
        }
        self.last_balance = b
        s,i,u,f = self.__get_position__()
        self.last_position = {
            \"side\":s,
            \"instrument\":i,
            \"units\":u,
            \"fukumi\":f
        }
        self.__get_oldest_ticket__()
        self.tsuchi_kun.send_dict('Tickets timeout', message)" . -9155) ((marker . 10977) . -901) ((marker) . -901) ((marker*) . 1) ((marker) . -901) ((marker*) . 28) ((marker) . -901) ((marker . 9930) . -840) 10056 (t 23318 25313 0 0) nil ("    
" . 9062) ((marker . 9970) . -5) nil ("        
" . 9062) ((marker . 9970) . -9) (t 23318 25293 0 0) nil (9036 . 9038) nil (" " . -9045) ((marker . 10977) . -1) ("-" . -9046) ((marker . 10977) . -1) (" " . -9047) ((marker . 10977) . -1) 9048 nil (9036 . 9048) nil (9035 . 9036) nil ("t['rate'] - " . 9018) ((marker . 11988) . -12) ((marker) . -12) (t 23318 25263 0 0) nil (9044 . 9047) nil ("aks" . 9044) nil (9044 . 9047) nil ("bid" . -9044) ((marker . 10977) . -3) 9047 (t 23318 25252 0 0) nil (8644 . 8647) nil ("bi" . -8644) ((marker . 10977) . -2) 8646 nil ("d" . -8646) ((marker . 10977) . -1) 8647 nil (8472 . 8475) nil ("bid" . -8472) ((marker . 10977) . -3) 8475 nil (8528 . 8531) nil ("bid" . -8528) ((marker . 10977) . -3) 8531 nil (8712 . 8715) nil ("bid" . -8712) ((marker . 10977) . -3) 8715 nil (9001 . 9061) nil (8980 . 9001) nil (8979 . 8980) nil ("    " . -8975) 8983 nil (8979 . 8983) nil (8958 . 8979) nil (8894 . 8898) 8878 nil (8854 . 8877) nil (8837 . 8854) nil (8867 . 8868) nil ("＋" . -8867) ((marker . 10977) . -1) (8867 . 8868) ("＋" . -8867) ((marker . 10977) . -1) (8867 . 8868) ("-" . -8867) ((marker . 10977) . -1) 8868 nil (8854 . 8914) (t 23318 25184 0 0) nil (8837 . 8854) nil ("の" . -8790) ((marker . 10977) . -1) ("更" . -8791) ((marker . 10977) . -1) ("新" . -8792) ((marker . 10977) . -1) 8793 nil ("
" . -8840) ((marker . 11988) . -1) ((marker) . -1) ((marker) . -1) ((marker . 10977) . -1) ((marker . 7973) . -1) ((marker . 7973) . -1) ((marker . 9930) . -1) 8841 nil ("                
                    
        # タイムアウトの更新" . -8841) ((marker) . -17) ((marker) . -17) ((marker) . -38) ((marker) . -38) ((marker . 10977) . -57) ((marker . 7973) . -37) ((marker . 7973) . -37) ((marker) . -57) ((marker . 9930) . -38) 8898 nil (8791 . 8793) ("更新" . -8791) ((marker . 10977) . -2) (8791 . 8793) ("こうしｎ" . -8791) ((marker . 10977) . -4) (8791 . 8795) ("こうし" . -8791) ((marker . 10977) . -3) 8794 nil (8791 . 8794) ("こうｓ" . -8791) (8791 . 8794) ("こう" . -8791) ((marker . 10977) . -2) (8791 . 8793) ("こ" . -8791) ((marker . 10977) . -1) (8791 . 8792) ("ｋ" . -8791) ((marker . 10977) . -1) (8787 . 8792) ("アウトの" . -8787) ((marker . 10977) . -4) (8787 . 8791) ("あうとの" . -8787) ((marker . 10977) . -4) (8787 . 8791) ("あうとｎ" . -8787) ((marker . 10977) . -4) (8787 . 8791) ("あうと" . -8787) ((marker . 10977) . -3) (8787 . 8790) ("あうｔ" . -8787) ((marker . 10977) . -3) (8787 . 8790) ("あう" . -8787) ((marker . 10977) . -2) (8787 . 8789) ("あ" . -8787) ((marker . 10977) . -1) (8784 . 8788) nil ("タイム" . -8784) ((marker . 10977) . -3) (8784 . 8787) ("たいむ" . -8784) ((marker . 10977) . -3) (8784 . 8787) ("たいｍ" . -8784) ((marker . 10977) . -3) (8784 . 8787) ("たい" . -8784) ((marker . 10977) . -2) (8784 . 8786) ("た" . -8784) ((marker . 10977) . -1) (8784 . 8785) ("ｔ" . -8784) ((marker . 10977) . -1) (8784 . 8785) ("    " . -8782) 8788 nil ("    " . -8786) 8792 nil (8790 . 8792) nil (8770 . 8790) ("    " . 8770) (8769 . 8770) ("                " . 8769) ((marker . 10977) . -16) 8785 nil (8836 . 8853) nil (8835 . 8836) nil (8827 . 8835) ("now_" . -8827) ((marker . 10977) . -4) 8831 nil (8827 . 8831) nil (8819 . 8827) nil (8812 . 8817) nil ("a" . -8812) (8812 . 8813) ("t" . -8812) (8812 . 8813) ("s" . -8812) (8812 . 8813) nil (8808 . 8812) (8807 . 8809) ("'" . -8807) (8807 . 8808) nil ("t" . -8807) ((marker . 10977) . -1) 8808 nil (8807 . 8808) (8806 . 8808) ("[" . -8806) (8804 . 8807) nil (8768 . 8789) nil (8781 . 8783) nil ("    " . -8781) ((marker . 10977) . -4) 8785 nil ("    " . -8785) ((marker . 10977) . -4) 8789 nil (8768 . 8789) (t 23318 25097 0 0) nil (8403 . 8406) ("損切り" . -8403) ((marker . 10977) . -3) (8403 . 8406) ("そんぎり" . -8403) ((marker . 10977) . -4) (8403 . 8407) ("そんぎｒ" . -8403) ((marker . 10977) . -4) (8403 . 8407) ("そんぎ" . -8403) ((marker . 10977) . -3) (8403 . 8406) ("そんぎち" . -8403) ((marker . 10977) . -4) (8403 . 8407) ("そんぎｔ" . -8403) ((marker . 10977) . -4) (8403 . 8407) ("そんぎ" . -8403) ((marker . 10977) . -3) (8403 . 8406) ("そんｇ" . -8403) ((marker . 10977) . -3) (8403 . 8406) ("そｎ" . -8403) ((marker . 10977) . -2) (8403 . 8405) ("そ" . -8403) ((marker . 10977) . -1) (8403 . 8404) ("ｓ" . -8403) ((marker . 10977) . -1) (8401 . 8404) nil ("利確" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("離隔" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("利確" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("りかく" . -8401) ((marker . 10977) . -3) (8401 . 8404) ("りかｋ" . -8401) ((marker . 10977) . -3) (8401 . 8404) ("りか" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("りｋ" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("り" . -8401) ((marker . 10977) . -1) (8401 . 8402) ("ｒ" . -8401) ((marker . 10977) . -1) 8402 nil (8401 . 8402) ("り" . -8401) ((marker . 10977) . -1) ("書" . -8402) ((marker . 10977) . -1) ("く" . -8403) ((marker . 10977) . -1) 8404 nil ("ｓ" . -8404) ((marker . 10977) . -1) (8401 . 8405) ("り書く" . -8401) ((marker . 10977) . -3) (8401 . 8404) ("りかく" . -8401) ((marker . 10977) . -3) (8401 . 8404) ("りかｋ" . -8401) ((marker . 10977) . -3) (8401 . 8404) ("りか" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("りｋ" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("り" . -8401) ((marker . 10977) . -1) (8401 . 8402) ("ｒ" . -8401) ((marker . 10977) . -1) (8400 . 8402) nil ("の" . -8400) ((marker . 10977) . -1) (8400 . 8401) ("ｎ" . -8400) ((marker . 10977) . -1) (8400 . 8401) ("ん" . -8400) ((marker . 10977) . -1) 8401 nil ("り" . -8401) ((marker . 10977) . -1) (8401 . 8402) ("りｋ" . -8401) ((marker . 10977) . -2) (8401 . 8403) ("り" . -8401) ((marker . 10977) . -1) (8401 . 8402) ("ｒ" . -8401) ((marker . 10977) . -1) (8397 . 8402) nil ("サイドん" . -8397) ((marker . 10977) . -4) (8397 . 8401) ("さいどｎ" . -8397) ((marker . 10977) . -4) (8397 . 8401) ("さいど" . -8397) ((marker . 10977) . -3) (8397 . 8400) ("さいｄ" . -8397) ((marker . 10977) . -3) (8397 . 8400) ("さい" . -8397) ((marker . 10977) . -2) (8397 . 8399) ("さ" . -8397) ((marker . 10977) . -1) (8397 . 8398) ("ｓ" . -8397) ((marker . 10977) . -1) (8397 . 8398) ("再" . -8397) ((marker . 10977) . -1) ("度" . -8398) ((marker . 10977) . -1) ("ん" . -8399) ((marker . 10977) . -1) 8400 nil (8397 . 8400) ("再度ん" . -8397) ((marker . 10977) . -3) (8397 . 8400) ("さいどｎ" . -8397) ((marker . 10977) . -4) (8397 . 8401) ("さいど" . -8397) ((marker . 10977) . -3) (8397 . 8400) ("さいｄ" . -8397) ((marker . 10977) . -3) (8397 . 8400) ("さい" . -8397) ((marker . 10977) . -2) (8397 . 8399) ("さ" . -8397) ((marker . 10977) . -1) (8397 . 8398) ("ｓ" . -8397) ((marker . 10977) . -1) (8397 . 8398) ("し" . -8397) ((marker . 10977) . -1) (8397 . 8398) ("しあ" . -8397) ((marker . 10977) . -2) (8397 . 8399) ("しあ" . -8397) (8397 . 8399) ("ｓ" . -8397) ((marker . 10977) . -1) (8394 . 8398) nil ("    " . -8392) 8398 nil ("    " . -8396) 8402 nil (8400 . 8402) nil (8379 . 8400) (t 23318 24990 0 0) nil (8780 . 8782) ("更新" . -8780) ((marker . 10977) . -2) (8780 . 8782) ("こうしｎ" . -8780) ((marker . 10977) . -4) (8780 . 8784) ("こうし" . -8780) ((marker . 10977) . -3) (8780 . 8783) ("こうｓ" . -8780) ((marker . 10977) . -3) (8780 . 8783) ("こう" . -8780) ((marker . 10977) . -2) (8780 . 8782) ("こ" . -8780) ((marker . 10977) . -1) (8780 . 8781) ("ｋ" . -8780) ((marker . 10977) . -1) (8779 . 8781) nil ("の" . -8779) ((marker . 10977) . -1) (8779 . 8780) ("ｎ" . -8779) ((marker . 10977) . -1) (8779 . 8780) ("の" . -8779) ((marker . 10977) . -1) ("確" . -8780) ((marker . 10977) . -1) ("認" . -8781) ((marker . 10977) . -1) 8782 (t 23318 24927 0 0) nil (8782 . 8791) nil (8741 . 8762) nil ("    " . -8750) ((marker . 10977) . -4) 8754 nil ("    " . -8754) ((marker . 10977) . -4) 8758 nil ("    " . -8758) ((marker . 10977) . -4) 8762 nil (8742 . 8762) ("        " . 8742) nil ("
" . 8742) ((marker) . -1) ((marker) . -1) ((marker . 9970) . -1) nil ("            
" . 8742) ((marker) . -13) ((marker) . -13) ((marker . 9970) . -13) nil ("            
" . 8742) ((marker) . -13) ((marker) . -13) ((marker . 9970) . -13) nil ("                    
" . 8742) ((marker) . -21) ((marker) . -21) ((marker . 9970) . -21) (t 23318 24857 0 0) nil (" " . -8688) ((marker . 10977) . -1) ("-" . -8689) ((marker . 10977) . -1) (" " . -8690) ((marker . 10977) . -1) 8691 nil (8671 . 8691) nil (8669 . 8671) nil ("=" . -8669) ((marker . 10977) . -1) 8670 nil (8668 . 8670) nil ("self." . -8659) ((marker . 10977) . -5) 8664 nil ("now_" . -8664) ((marker . 10977) . -4) 8668 nil ("rate_" . -8668) ((marker . 10977) . -5) 8673 nil ("bid - " . -8673) ((marker . 10977) . -6) 8679 nil (8601 . 8602) nil ("<" . -8601) ((marker . 10977) . -1) 8602 nil (" " . -8516) ((marker . 10977) . -1) ("-" . -8517) ((marker . 10977) . -1) (" " . -8518) ((marker . 10977) . -1) 8519 nil (8507 . 8519) nil (8504 . 8507) nil ("t['" . -8487) ((marker . 10977) . -3) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) ((marker . 7650) . -1) 8490 nil ("rate'] - " . -8490) ((marker . 10977) . -9) 8499 nil (8429 . 8430) nil (">" . -8429) ((marker . 10977) . -1) 8430 (t 23318 24825 0 0) nil (8392 . 8396) nil ("if t['side'] == 'sell'" . -8392) ((marker . 10977) . -22) ((marker) . -22) 8414 nil ("    " . -8392) ((marker . 10977) . -4) 8396 nil ("    " . -8396) ((marker . 10977) . -4) 8400 nil (8380 . 8400) ("            " . 8380) ((marker) . -12) nil ("                        " . -8741) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) ((marker . 7886) . -24) (8721 . 8741) ("                        " . -8660) ((marker . 7805) . -24) ((marker . 7805) . -24) ((marker . 7805) . -24) ((marker . 7805) . -24) (8640 . 8660) ("                    " . -8604) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) ((marker . 7749) . -20) (8588 . 8604) ("                        " . -8569) (8549 . 8569) ("                        " . -8488) ((marker . 7633) . -24) ((marker . 7633) . -24) ((marker . 7633) . -24) ((marker . 7633) . -24) (8468 . 8488) ("                    " . -8432) ((marker . 7577) . -20) ((marker . 7577) . -20) (8416 . 8432) ("                " . -8392) ((marker) . -16) (8380 . 8392) 8787 nil ("
" . 8380) ((marker) . -1) ((marker) . -1) ((marker . 9970) . -1) nil ("            else:" . 8380) nil (">" . -8805) ((marker . 10977) . -1) 8806 nil (8805 . 8806) nil ("                    " . -8787) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) ((marker . 7886) . -20) (8763 . 8787) ("                    " . -8702) ((marker . 7805) . -20) ((marker . 7805) . -20) ((marker . 7805) . -20) ((marker . 7805) . -20) (8678 . 8702) ("                " . -8642) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) ((marker . 7749) . -16) (8622 . 8642) ("                    " . -8603) (8579 . 8603) ("                    " . -8518) ((marker . 7633) . -20) ((marker . 7633) . -20) ((marker . 7633) . -20) ((marker . 7633) . -20) (8494 . 8518) ("                " . -8458) ((marker . 7577) . -16) ((marker . 7577) . -16) ((marker) . -16) (8438 . 8458) 8781 nil (8414 . 8781) nil (8397 . 8414) nil ("    " . -8392) 8400 nil (8401 . 8422) nil (8380 . 8396) ("            " . 8380) (8396 . 8397) (t 23318 24596 0 0) nil (8317 . 8326) nil ("self." . -8317) ((marker . 10977) . -5) 8322 nil (8314 . 8322) nil ("t" . -8297) ((marker . 10977) . -1) ("[" . -8298) ((marker . 10977) . -1) ("'" . -8299) ((marker . 10977) . -1) ("r" . -8300) ((marker . 10977) . -1) ("a" . -8301) ((marker . 10977) . -1) ("t" . -8302) ((marker . 10977) . -1) ("e" . -8303) ((marker . 10977) . -1) ("'" . -8304) ((marker . 10977) . -1) ("]" . -8305) ((marker . 10977) . -1) ((marker*) . 1) ((marker) . -1) ((marker) . -1) (" " . -8306) ((marker . 10977) . -1) ("-" . -8307) ((marker . 10977) . -1) (" " . -8308) ((marker . 10977) . -1) 8309 nil (8328 . 8340) nil (8327 . 8328) nil (8326 . 8327) ("(" . 8297) (8296 . 8297) (8296 . 8297) ("(" . -8325) (8325 . 8326) (t 23318 24444 0 0) nil (8161 . 8166) (8160 . 8162) ("'" . -8160) (8160 . 8161) (8159 . 8161) ("[" . -8159) (8155 . 8160) nil (" " . -8154) ((marker . 10977) . -1) 8155 nil (8155 . 8156) ("(" . 8125) (8124 . 8125) (8124 . 8125) ("(" . -8154) (8154 . 8155) nil (8279 . 8280) nil ("+" . -8279) ((marker . 10977) . -1) 8280 nil (8332 . 8350) nil (8311 . 8332) (" " . 8311) ((marker . 10977) . -1) 8312 nil (8266 . 8312) nil (8245 . 8266) nil (8225 . 8226) nil (">" . -8225) ((marker . 10977) . -1) 8226 nil (8218 . 8222) nil ("profit" . -8218) ((marker . 10977) . -6) 8224 nil (8215 . 8247) nil (8214 . 8215) nil ("    " . -8210) 8218 nil (8216 . 8218) nil ("s" . -8216) ((marker . 10977) . -1) ("e" . -8217) ((marker . 10977) . -1) 8218 nil (8214 . 8218) nil (8193 . 8214) nil (7900 . 7909) nil (7987 . 7990) nil ("損切り" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんぎり" . -7987) ((marker . 10977) . -4) (7987 . 7991) ("そんぎｒ" . -7987) ((marker . 10977) . -4) 7991 nil (7987 . 7991) ("そんぎ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんｇ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そｎ" . -7987) ((marker . 10977) . -2) (7987 . 7989) ("そ" . -7987) ((marker . 10977) . -1) (7987 . 7988) ("ｓ" . -7987) ((marker . 10977) . -1) (7987 . 7988) ("村" . -7987) ((marker . 10977) . -1) ("議" . -7988) ((marker . 10977) . -1) ("r" . -7989) ((marker . 10977) . -1) ("い" . -7990) ((marker . 10977) . -1) 7991 nil (7990 . 7991) ("い" . -7990) ((marker . 10977) . -1) (7987 . 7991) nil ("村議r" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんぎｒ" . -7987) ((marker . 10977) . -4) (7987 . 7991) ("そんぎ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんｇ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そｎ" . -7987) ((marker . 10977) . -2) (7987 . 7989) ("そ" . -7987) ((marker . 10977) . -1) (7987 . 7988) ("ｓ" . -7987) ((marker . 10977) . -1) (7987 . 7988) ("村" . -7987) ((marker . 10977) . -1) ("議" . -7988) ((marker . 10977) . -1) ("r" . -7989) ((marker . 10977) . -1) 7990 nil ("い" . -7990) ((marker . 10977) . -1) (7987 . 7991) ("村議r" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんぎｒ" . -7987) ((marker . 10977) . -4) (7987 . 7991) ("そんぎ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんぎち" . -7987) ((marker . 10977) . -4) (7987 . 7991) ("そんぎｔ" . -7987) ((marker . 10977) . -4) (7987 . 7991) ("そんぎ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そんｇ" . -7987) ((marker . 10977) . -3) (7987 . 7990) ("そｎ" . -7987) ((marker . 10977) . -2) (7987 . 7989) ("そ" . -7987) ((marker . 10977) . -1) (7987 . 7988) ("ｓ" . -7987) ((marker . 10977) . -1) (7985 . 7988) nil ("利確" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("りかく" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りかｋ" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りか" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("りｋ" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("り" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("ｒ" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("り" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("りっ" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("りっく" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りっｋ" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りｋ" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("り" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("ｒ" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("り" . -7985) ((marker . 10977) . -1) ("か" . -7986) ((marker . 10977) . -1) ("く" . -7987) ((marker . 10977) . -1) ("　" . -7988) ((marker . 10977) . -1) 7989 nil (7985 . 7989) ("りかく" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りかｋ" . -7985) ((marker . 10977) . -3) (7985 . 7988) ("りか" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("りｋ" . -7985) ((marker . 10977) . -2) (7985 . 7987) ("り" . -7985) ((marker . 10977) . -1) (7985 . 7986) ("ｒ" . -7985) ((marker . 10977) . -1) (7985 . 7986) nil (7981 . 7985) ("サイドの" . -7981) ((marker . 10977) . -4) (7981 . 7985) ("さいどの" . -7981) ((marker . 10977) . -4) (7981 . 7985) ("さいどｎ" . -7981) ((marker . 10977) . -4) (7981 . 7985) ("さいど" . -7981) ((marker . 10977) . -3) (7981 . 7984) ("さいｄ" . -7981) ((marker . 10977) . -3) (7981 . 7984) ("さい" . -7981) ((marker . 10977) . -2) (7981 . 7983) ("さ" . -7981) ((marker . 10977) . -1) (7981 . 7982) ("ｓ" . -7981) ((marker . 10977) . -1) (7977 . 7982) nil (7975 . 7977) nil (7962 . 7975) nil ("
" . -7998) ((marker) . -1) ((marker) . -1) ((marker . 10977) . -1) ((marker . 7171) . -1) ((marker . 9930) . -1) 7999 nil ("                # " . 7999) ((marker . 7171) . -16) nil (8015 . 8017) nil ("-" . -8015) ((marker . 10977) . -1) 8016 nil (8015 . 8016) nil (7998 . 8015) (t 23318 24346 0 0) nil (8096 . 8099) nil (8090 . 8094) (8089 . 8091) ("'" . -8089) (8089 . 8090) nil (";" . -8089) ((marker . 10977) . -1) ("'" . -8090) ((marker . 10977) . -1) ("'" . 8091) nil (8090 . 8092) ("'" . -8090) (8089 . 8091) (8088 . 8090) ("[" . -8088) (8088 . 8089) nil ("[" . -8088) ((marker . 10977) . -1) ("]" . 8089) nil (8088 . 8090) ("[" . -8088) (8087 . 8089) nil ("t" . -8087) ((marker . 10977) . -1) 8088 nil (8087 . 8088) nil ("-" . -8105) ((marker . 10977) . -1) (" " . -8106) ((marker . 10977) . -1) ("t" . -8107) ((marker . 10977) . -1) 8108 nil (8104 . 8108) nil (8087 . 8104) nil (8084 . 8085) nil ("=" . -8084) ((marker . 10977) . -1) 8085 nil (8084 . 8085) nil (8083 . 8086) nil (8076 . 8083) ("ba" . -8076) ((marker . 10977) . -2) 8078 nil (8071 . 8078) nil ("t" . 8071) nil (8071 . 8072) nil (8050 . 8071) nil (8087 . 8088) (8086 . 8088) ("(" . -8086) (8082 . 8087) nil (8071 . 8082) ("ticke" . -8071) ((marker . 10977) . -5) 8076 nil (8071 . 8076) nil (8050 . 8071) nil (8046 . 8050) nil ("ask" . -8046) ((marker . 10977) . -3) 8049 nil (8037 . 8049) ("now" . -8037) ((marker . 10977) . -3) 8040 nil (8030 . 8040) nil (">" . -8030) ((marker . 10977) . -1) (" " . -8031) ((marker . 10977) . -1) 8032 nil (8029 . 8032) nil (8021 . 8027) nil ("s" . -8021) ((marker . 10977) . -1) ((marker . 10977) . -1) 8022 nil ("i" . -8022) ((marker . 10977) . -1) ("d" . -8023) ((marker . 10977) . -1) ("e" . -8024) ((marker . 10977) . -1) 8025 nil (8021 . 8025) nil ("r" . -8021) ((marker . 10977) . -1) 8022 nil (8021 . 8022) nil (7960 . 7961) ("(" . 7949) (7948 . 7949) (7948 . 7949) ("(" . -7959) (7959 . 7960) nil (7939 . 7948) nil ("e" . -7939) ((marker . 11988) . -1) ((marker . 10977) . -1) ("n" . -7940) ((marker . 11988) . -1) ((marker . 10977) . -1) ("u" . -7941) ((marker . 11988) . -1) ((marker . 10977) . -1) 7942 nil (7939 . 7942) nil (7932 . 7934) nil (8007 . 8009) ("'" . -8007) (8007 . 8008) (8006 . 8008) ("[" . -8006) (8006 . 8007) nil ("'" . -8006) ((marker . 10977) . -1) ("'" . 8007) nil (8006 . 8008) ("'" . -8006) (8002 . 8007) nil ("f" . -8002) ((marker . 10977) . -1) ("i" . -8003) ((marker . 10977) . -1) 8004 nil (8002 . 8004) nil ("t" . -8002) ((marker . 10977) . -1) 8003 nil (8002 . 8003) nil (" " . -7984) ((marker . 10977) . -1) ("a" . -7985) ((marker . 10977) . -1) ("n" . -7986) ((marker . 10977) . -1) ("d" . -7987) ((marker . 10977) . -1) (" " . -7988) ((marker . 10977) . -1) ("t" . -7989) ((marker . 10977) . -1) 7990 nil (7985 . 7990) nil ("a" . -7985) ((marker . 10977) . -1) ("n" . -7986) ((marker . 10977) . -1) ("d" . -7987) ((marker . 10977) . -1) (" " . -7988) ((marker . 10977) . -1) 7989 nil (7986 . 7989) nil ("d" . -7986) ((marker . 10977) . -1) ("n" . -7987) ((marker . 10977) . -1) (" " . -7988) ((marker . 10977) . -1) 7989 nil (7984 . 7989) nil ("t[]" . 8002) nil (8003 . 8005) ("[" . -8003) (8003 . 8004) nil (8002 . 8003) nil (7985 . 8002) nil ("    " . -7998) 8006 nil (8002 . 8006) nil (7985 . 8002) nil (7984 . 7985) nil (7979 . 7983) nil ("'" . 7980) (7979 . 7980) (7978 . 7980) ("'" . -7978) (7977 . 7979) nil (7977 . 7990) (" " . 7977) ((marker . 10977) . -1) 7978 nil (7977 . 7978) nil (7977 . 7990) (" " . 7977) ((marker . 10977) . -1) 7978 nil (7974 . 7978) nil (7968 . 7972) (7967 . 7969) ("'" . -7967) (7967 . 7968) nil (7966 . 7968) ("[" . -7966) (7965 . 7967) nil ("t" . -7965) ((marker . 10977) . -1) 7966 nil (7962 . 7966) nil ("t" . -7962) ((marker . 10977) . -1) 7963 nil (7962 . 7963) nil (7949 . 7962) nil (7948 . 7949) nil (7937 . 7948) ("tic" . -7937) ((marker . 10977) . -3) 7940 nil (7932 . 7940) nil (7928 . 7932) nil ("i" . -7928) ((marker . 10977) . -1) ("f" . -7929) ((marker . 10977) . -1) 7930 nil (7928 . 7930) nil (7919 . 7928) nil ("        " . -7929) 7921 nil (nil rear-nonsticky nil 7947 . 7948) (7929 . 7948) nil (7920 . 7929) ("        " . 7920) ((marker . 10977) . -8) 7928 nil (7919 . 7928) nil ("
" . -7900) ((marker . 10977) . -1) ((marker) . -1) ((marker) . -1) ((marker . 11988) . -1) ((marker . 7036) . -1) ((marker . 7036) . -1) ((marker . 7036) . -1) ((marker . 9930) . -1) ("
" . -7901) ((marker . 10977) . -1) ((marker) . -1) ((marker) . -1) ((marker . 9930) . -1) 7902 nil ("        # タイムアウトの確認" . 7901) nil ("    " . -7921) ((marker . 10977) . -4) ((marker . 7036) . -4) ((marker) . -4) 7925 nil ("    " . -7925) ((marker . 10977) . -4) ((marker) . -4) ((marker) . -4) 7929 nil (7920 . 7929) (t 23318 23860 0 0) nil (7937 . 7939) ("更新" . -7937) ((marker . 10977) . -2) (7937 . 7939) ("こうしｎ" . -7937) ((marker . 10977) . -4) (7937 . 7941) ("こうし" . -7937) ((marker . 10977) . -3) (7937 . 7940) ("こうｓ" . -7937) ((marker . 10977) . -3) (7937 . 7940) ("こう" . -7937) ((marker . 10977) . -2) (7937 . 7939) ("こ" . -7937) ((marker . 10977) . -1) (7937 . 7938) ("ｋ" . -7937) ((marker . 10977) . -1) (7933 . 7938) ("損切りの" . -7933) ((marker . 10977) . -4) (7933 . 7937) ("そんぎりの" . -7933) ((marker . 10977) . -5) (7933 . 7938) ("そんぎりｎ" . -7933) ((marker . 10977) . -5) (7933 . 7938) ("そんぎり" . -7933) ((marker . 10977) . -4) (7933 . 7937) ("そんぎｒ" . -7933) ((marker . 10977) . -4) (7933 . 7937) ("そんぎ" . -7933) ((marker . 10977) . -3) (7933 . 7936) ("そんぎｔ" . -7933) ((marker . 10977) . -4) (7933 . 7937) ("そんぎ" . -7933) ((marker . 10977) . -3) (7933 . 7936) ("そんｇ" . -7933) (7933 . 7936) ("そｎ" . -7933) ((marker . 10977) . -2) (7933 . 7935) ("そ" . -7933) ((marker . 10977) . -1) (7933 . 7934) ("ｓ" . -7933) ((marker . 10977) . -1) (7931 . 7934) nil ("利確" . -7931) ((marker . 10977) . -2) (7931 . 7933) ("りかく" . -7931) ((marker . 10977) . -3) (7931 . 7934) ("りかｋ" . -7931) ((marker . 10977) . -3) (7931 . 7934) ("りか" . -7931) ((marker . 10977) . -2) (7931 . 7933) ("りｋ" . -7931) ((marker . 10977) . -2) (7931 . 7933) ("り" . -7931) ((marker . 10977) . -1) (7931 . 7932) ("ｒ" . -7931) ((marker . 10977) . -1) (7929 . 7932) nil (7920 . 7929) (t 23318 23854 0 0) nil (7918 . 7920) ("確認" . -7918) ((marker . 10977) . -2) (7918 . 7920) ("かくにｎ" . -7918) ((marker . 10977) . -4) (7918 . 7922) ("かくに" . -7918) ((marker . 10977) . -3) (7918 . 7921) ("かくｎ" . -7918) ((marker . 10977) . -3) (7918 . 7921) ("かく" . -7918) ((marker . 10977) . -2) (7918 . 7920) ("かｋ" . -7918) ((marker . 10977) . -2) (7918 . 7920) ("か" . -7918) ((marker . 10977) . -1) (7918 . 7919) ("ｋ" . -7918) ((marker . 10977) . -1) (7914 . 7919) ("アウトの" . -7914) ((marker . 10977) . -4) (7914 . 7918) ("あうとの" . -7914) ((marker . 10977) . -4) (7914 . 7918) ("あうとｎ" . -7914) ((marker . 10977) . -4) (7914 . 7918) ("あうと" . -7914) ((marker . 10977) . -3) (7914 . 7917) ("あうｔ" . -7914) ((marker . 10977) . -3) (7914 . 7917) ("あう" . -7914) ((marker . 10977) . -2) (7914 . 7916) ("あ" . -7914) ((marker . 10977) . -1) (7911 . 7915) nil ("タイム" . -7911) ((marker . 10977) . -3) (7911 . 7914) ("たいむ" . -7911) ((marker . 10977) . -3) (7911 . 7914) ("たいｍ" . -7911) ((marker . 10977) . -3) (7911 . 7914) ("たい" . -7911) ((marker . 10977) . -2) (7911 . 7913) ("た" . -7911) ((marker . 10977) . -1) (7911 . 7912) ("ｔ" . -7911) ((marker . 10977) . -1) (7911 . 7912) nil (7909 . 7911) nil (7900 . 7909) nil (7899 . 7900) nil (7894 . 7898) (7893 . 7895) ("(" . -7893) (7893 . 7894) nil (7871 . 7893) ("__up" . -7871) ((marker . 10977) . -4) 7875 nil (7873 . 7875) nil ("tic" . -7873) ((marker . 10977) . -3) 7876 nil ("k" . -7876) ((marker . 10977) . -1) 7877 nil (7875 . 7877) nil ("c" . -7875) ((marker . 10977) . -1) ("k" . -7876) ((marker . 10977) . -1) 7877 nil (7870 . 7877) nil (7867 . 7870) nil (7862 . 7867) (t 23318 23781 0 0) nil (7852 . 7854) ("更新" . -7852) (7852 . 7854) ("こうしｎ" . -7852) (7852 . 7856) ("こうし" . -7852) (7852 . 7855) ("こうｓ" . -7852) (7852 . 7855) ("こう" . -7852) (7852 . 7854) ("こ" . -7852) (7852 . 7853) ("ｋ" . -7852) (7851 . 7853) nil ("を" . -7851) (7851 . 7852) ("ｗ" . -7851) (7851 . 7852) ("ｗ" . -7851) 7852 nil (7848 . 7852) ("リストｗ" . -7848) (7848 . 7852) ("りすとｗ" . -7848) (7848 . 7852) ("りすと" . -7848) (7848 . 7851) ("りすｔ" . -7848) 7851 nil (7848 . 7851) ("りす" . -7848) (7848 . 7850) ("りｓ" . -7848) (7848 . 7850) ("り" . -7848) (7848 . 7849) ("ｒ" . -7848) (7847 . 7849) ("の" . -7847) (7847 . 7848) ("ｎ" . -7847) (7843 . 7848) nil ("チケット" . -7843) (7843 . 7847) ("ちけっと" . -7843) (7843 . 7847) ("ちけっｔ" . -7843) (7843 . 7847) ("ちけｔ" . -7843) (7843 . 7846) ("ちけ" . -7843) (7843 . 7845) ("ちｋ" . -7843) (7843 . 7845) ("ち" . -7843) (7843 . 7844) ("ｔ" . -7843) (7843 . 7844) ("ふ" . -7843) (7843 . 7844) ("ふぁ" . -7843) (7843 . 7845) ("ｆ" . -7843) (7838 . 7844) nil (7838 . 7843) nil (7835 . 7841) ("'''" . -7835) (7837 . 7838) nil (";" . -7837) 7838 nil (7838 . 7843) nil (7837 . 7838) ("'" . 7837) (7836 . 7837) (7835 . 7837) ("'" . -7835) (7835 . 7836) nil ("    " . -7835) 7839 nil (7830 . 7839) (t 23318 23766 0 0) nil (7916 . 7920) nil ("l" . -7916) ("a" . -7917) 7918 nil (7917 . 7918) nil ("a" . -7917) ("s" . -7918) 7919 nil (7915 . 7919) nil ("false" . -7915) 7920 nil (7908 . 7920) nil ("retrun " . -7908) 7915 nil ("f" . -7915) ("a" . -7916) 7917 nil (7913 . 7917) nil (" " . -7913) ("n" . -7914) 7915 nil (7908 . 7915) (t 23318 23729 0 0) nil ("
" . 4255) nil ("        self.__check_limit__()" . 4255) nil ("
" . -6451) ("
" . -6452) ("
    '''
    損切・利確を調べる
    '''
    def __check_limit__(self):
        balance = self.__get_balance__()
        s,i,u,f = self.__get_position__()
        if balance != -1:
            diff_b = balance - self.last_balance
            diff_u = u - self.last_position['units']
            if diff_b < 0:
                side = \"loss\"
                title = \"Stop loss\"
                message = {
                    \"ユニット\":\"{:,d}\".format(diff_u),
                    \"損失\":\"¥{:,d}\".format(diff_b)
                }
            elif diff_b > 0:
                side = \"profit\"
                title = \"Take profit\"
                message = {
                    \"ユニット\":\"{:,d}\".format(diff_u),
                    \"利益\":\"¥{:,d}\".format(diff_b)
                }
            else:
                side = \"no\"
            self.last_balance = balance
            self.last_position = {
                \"side\":s,
                \"instrument\":i,
                \"units\":u,
                \"fukumi\":f
            }
            self.last_limit = {
                \"side\":side,
                \"units\":diff_u,
                \"diff\":diff_b
            }
            if side != \"no\":
                self.tsuchi_kun.send_dict(title, message)" . -6453) 7680 (t 23318 23672 0 0) nil ("
" . 4324) nil (4319 . 4321) nil (")" . -4319) (")" . -4320) 4321 nil (4319 . 4321) nil (4319 . 4321) ("(" . -4319) (4308 . 4320) nil ("ticket" . -4308) 4314 nil ("_" . -4314) 4315 nil (4314 . 4315) nil ("_" . -4314) 4315 nil (4308 . 4315) nil (4299 . 4308) nil ("u" . -4299) ("p" . -4300) 4301 nil (4294 . 4301) nil ("せ" . -4294) (4294 . 4295) ("せｌ" . -4294) (4294 . 4296) ("せｌｆ" . -4294) (4294 . 4297) ("せｌｆ．" . -4294) (4294 . 4298) ("せｌｆ" . -4294) (4294 . 4297) ("せｌ" . -4294) (4294 . 4296) ("せ" . -4294) (4294 . 4295) ("せ" . -4294) (4285 . 4295) nil ("        ids = self.__get_timeout_ticket_ids__(now_time_utc)
        self.__close_tickets__(ids)" . -4286) 4381 nil ("        
" . 4286) nil ("
" . 4286) nil ("        # 以下の2つの" . 4286) nil (4303 . 4312) nil ("        
" . 4303) nil (4302 . 4311) nil ("め" . -4302) (4302 . 4303) ("めそ" . -4302) (4302 . 4304) ("めそっ" . -4302) (4302 . 4305) ("めそっで" . -4302) (4302 . 4306) ("めそっでお" . -4302) (4302 . 4307) ("めそっで" . -4302) (4302 . 4306) ("めそっｄ" . -4302) (4302 . 4306) ("めそｄ" . -4302) (4302 . 4305) ("めそ" . -4302) (4302 . 4304) ("めｓ" . -4302) (4302 . 4304) ("め" . -4302) (4302 . 4303) ("ｍ" . -4302) (4299 . 4303) ("2つの" . -4299) (4299 . 4302) ("２つの" . -4299) (4299 . 4302) ("２つｎ" . -4299) (4299 . 4302) ("２つ" . -4299) (4299 . 4301) ("２ｔ" . -4299) (4299 . 4301) ("２" . -4299) (4299 . 4300) ("２" . -4299) (4299 . 4300) ("２ご" . -4299) (4299 . 4301) ("２ごう" . -4299) (4299 . 4302) ("２ご" . -4299) (4299 . 4301) ("２ｇ" . -4299) (4299 . 4301) ("２" . -4299) (4296 . 4300)))
